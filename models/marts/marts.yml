models:
  - name: fact_daily_revenue
    description: "Fact table aggregating daily revenues by product type, game genre, and payment method. All amounts are converted to PLN for unified financial reporting and analysis."
    columns:
      - name: transaction_date
        description: "Date for which the revenue is aggregated, must be in YYYY-MM-DD format"
        tests:
          - not_null
          - date_format:
              arguments:
                format: '%Y-%m-%d'
      - name: product_type
        description: "Type of product or service that generated the revenue (game, subscription, etc.)"
        tests:
          - not_null
      - name: genre
        description: "Game genre category for revenue analysis and trend identification"
        tests:
          - not_null
      - name: payment_method
        description: "Payment method used for the transactions in the revenue aggregation"
        tests:
          - not_null
      - name: daily_revenue
        description: "Total revenue amount for the day in PLN (converted from original currencies), must be positive"
        tests:
          - not_null
          - not_negative
      - name: currency
        description: "Currency of the aggregated revenue (always PLN for unified reporting)"
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['PLN']

  - name: dim_games
    description: "Dimension table containing game information for analytical context. Links to fact tables to provide game metadata for revenue analysis and reporting."
    columns:
      - name: id
        description: "Surrogate key for the game dimension, must be unique and not null"
        tests:
          - not_null
          - unique
      - name: game_title
        description: "Human-readable name of the game for reporting and analysis"
        tests:
          - not_null
      - name: genre
        description: "Game category/genre for analytical grouping and trend analysis"
        tests:
          - not_null

  - name: fact_reconciled_transactions
    description: "Fact table consolidating reconciled transactions from both internal and PSP systems. Provides a unified view of all transactions with conversion to PLN for financial reporting."
    columns:
      - name: reconciliation_status
        description: "Status of the reconciliation between internal and PSP transactions"
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['MATCH', 'ONLY IN GOG', 'ONLY IN PSP']